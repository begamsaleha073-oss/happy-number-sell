<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FireXOTP - WhatsApp Virtual Numbers</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background: #0f0f1a;
            color: #e0e0ff;
            line-height: 1.6;
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 500px;
            margin: 0 auto;
        }

        header {
            text-align: center;
            padding: 20px 0;
            margin-bottom: 20px;
        }

        .logo {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
            margin-bottom: 10px;
        }

        .logo i {
            font-size: 2.5rem;
            color: #4cc9f0;
        }

        .logo h1 {
            font-size: 2rem;
            font-weight: 800;
            background: linear-gradient(45deg, #4cc9f0, #4361ee, #f72585);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .main-card {
            background: rgba(20, 20, 35, 0.9);
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 20px;
            border: 1px solid rgba(67, 97, 238, 0.3);
        }

        .glow-btn {
            display: block;
            width: 100%;
            padding: 15px;
            background: linear-gradient(135deg, #4361ee, #4cc9f0, #f72585);
            color: white;
            border: none;
            border-radius: 10px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            margin-bottom: 20px;
        }

        .result-container {
            background: rgba(15, 15, 30, 0.9);
            border-radius: 10px;
            padding: 20px;
            margin-top: 20px;
            display: none;
            border: 1px solid rgba(67, 97, 238, 0.3);
        }

        .result-container.active {
            display: block;
        }

        .number-box {
            background: rgba(67, 97, 238, 0.1);
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 15px;
        }

        .result-number {
            font-size: 1.3rem;
            font-weight: 700;
            color: #4cc9f0;
            margin-bottom: 10px;
        }

        .otp-value {
            font-size: 1.8rem;
            font-weight: 700;
            color: #4cc9f0;
            letter-spacing: 3px;
            margin: 10px 0;
        }

        .actions {
            display: flex;
            gap: 10px;
            margin-top: 15px;
        }

        .btn {
            flex: 1;
            padding: 10px;
            border: none;
            border-radius: 8px;
            color: white;
            font-weight: 600;
            cursor: pointer;
        }

        .btn-success {
            background: #4cc9f0;
        }

        .btn-danger {
            background: #f72585;
        }

        .notification {
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%) translateY(-100px);
            background: rgba(30, 30, 50, 0.95);
            padding: 15px 20px;
            border-radius: 10px;
            border-left: 4px solid #4cc9f0;
            transition: transform 0.3s ease;
            z-index: 1000;
        }

        .notification.active {
            transform: translateX(-50%) translateY(0);
        }

        .notification.error {
            border-left-color: #f72585;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <div class="logo">
                <i class="fab fa-whatsapp"></i>
                <h1>FireXOTP</h1>
            </div>
            <p>Philippines WhatsApp Virtual Numbers</p>
        </header>

        <div class="main-card">
            <button id="getNumberBtn" class="glow-btn">
                Get Philippines WhatsApp Number
            </button>
            
            <div id="resultContainer" class="result-container">
                <div class="number-box">
                    <div class="result-title">Your WhatsApp Number</div>
                    <div class="result-number" id="resultNumber">---</div>
                    <div class="result-id">ID: <span id="resultId">---</span></div>
                </div>
                
                <div class="otp-section">
                    <div class="result-title">OTP Code</div>
                    <div class="otp-value" id="otpValue">---</div>
                    <button class="btn" id="refreshOtpBtn">Check OTP</button>
                    
                    <div class="actions">
                        <button class="btn btn-success" id="copyOtpBtn">Copy OTP</button>
                        <button class="btn btn-danger" id="cancelRequestBtn">Cancel</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="notification" class="notification">
        <span id="notificationText">Ready to get number</span>
    </div>

    <script>
        // Simple debug version
        const getNumberBtn = document.getElementById('getNumberBtn');
        const resultContainer = document.getElementById('resultContainer');
        const resultNumber = document.getElementById('resultNumber');
        const resultId = document.getElementById('resultId');
        const otpValue = document.getElementById('otpValue');
        const refreshOtpBtn = document.getElementById('refreshOtpBtn');
        const copyOtpBtn = document.getElementById('copyOtpBtn');
        const cancelRequestBtn = document.getElementById('cancelRequestBtn');
        const notification = document.getElementById('notification');
        const notificationText = document.getElementById('notificationText');

        const API_KEY = 'g18m2iehorj978taaw4ymb9yipnqyjga';
        const BASE_URL = 'https://firexotp.com/stubs/handler_api.php';

        let currentId = null;

        // Show notification
        function showNotification(message, type = 'success') {
            notificationText.textContent = message;
            notification.className = `notification ${type} active`;
            setTimeout(() => {
                notification.classList.remove('active');
            }, 3000);
        }

        // Test API connection first
        async function testAPI() {
            showNotification('Testing API connection...', 'success');
            
            try {
                // Simple test request
                const testUrl = `${BASE_URL}?action=getNumber&api_key=${API_KEY}&service=wa&country=51`;
                console.log('Testing URL:', testUrl);
                
                const response = await fetch(testUrl);
                const data = await response.text();
                
                console.log('API Response:', data);
                showNotification('API is working!', 'success');
                return true;
            } catch (error) {
                console.error('API Test Failed:', error);
                showNotification('API connection failed: ' + error.message, 'error');
                return false;
            }
        }

        // Get virtual number
        async function getVirtualNumber() {
            getNumberBtn.innerHTML = 'Getting Number...';
            getNumberBtn.disabled = true;

            try {
                const url = `${BASE_URL}?action=getNumber&api_key=${API_KEY}&service=wa&country=51`;
                console.log('Fetching from:', url);
                
                const response = await fetch(url);
                
                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }
                
                const data = await response.text();
                console.log('Raw Response:', data);

                if (data.startsWith('ACCESS_NUMBER:')) {
                    const parts = data.split(':');
                    const id = parts[1];
                    const number = parts[2];
                    
                    resultNumber.textContent = number;
                    resultId.textContent = id;
                    currentId = id;
                    resultContainer.classList.add('active');
                    
                    showNotification('Number received successfully!', 'success');
                } else {
                    throw new Error('Unexpected response: ' + data);
                }
            } catch (error) {
                console.error('Error:', error);
                showNotification('Error: ' + error.message, 'error');
            } finally {
                getNumberBtn.innerHTML = 'Get Philippines WhatsApp Number';
                getNumberBtn.disabled = false;
            }
        }

        // Get OTP
        async function getOtp() {
            if (!currentId) {
                showNotification('Please get a number first', 'error');
                return;
            }

            try {
                const url = `${BASE_URL}?action=getStatus&api_key=${API_KEY}&id=${currentId}`;
                const response = await fetch(url);
                const data = await response.text();
                
                console.log('OTP Response:', data);

                if (data.startsWith('STATUS_OK:')) {
                    const otp = data.split(':')[1];
                    otpValue.textContent = otp;
                    showNotification('OTP received!', 'success');
                } else if (data.includes('WAIT')) {
                    otpValue.textContent = 'Waiting for OTP...';
                    showNotification('Still waiting for OTP', 'success');
                } else {
                    otpValue.textContent = 'Not received yet';
                    showNotification('OTP not available', 'error');
                }
            } catch (error) {
                console.error('OTP Error:', error);
                showNotification('OTP Error: ' + error.message, 'error');
            }
        }

        // Cancel request
        async function cancelRequest() {
            if (!currentId) return;

            try {
                const url = `${BASE_URL}?action=setStatus&api_key=${API_KEY}&id=${currentId}&status=8`;
                await fetch(url);
                
                resultContainer.classList.remove('active');
                currentId = null;
                showNotification('Request cancelled', 'success');
            } catch (error) {
                showNotification('Cancel error: ' + error.message, 'error');
            }
        }

        // Copy OTP
        function copyOtp() {
            if (otpValue.textContent === '---' || otpValue.textContent.includes('Waiting') || otpValue.textContent.includes('Not received')) {
                showNotification('No OTP to copy', 'error');
                return;
            }

            navigator.clipboard.writeText(otpValue.textContent)
                .then(() => showNotification('OTP copied!', 'success'))
                .catch(() => showNotification('Copy failed', 'error'));
        }

        // Event listeners
        getNumberBtn.addEventListener('click', getVirtualNumber);
        refreshOtpBtn.addEventListener('click', getOtp);
        copyOtpBtn.addEventListener('click', copyOtp);
        cancelRequestBtn.addEventListener('click', cancelRequest);

        // Test API on load
        window.addEventListener('load', testAPI);

        // Debug info
        console.log('FireXOTP Debug Version Loaded');
        console.log('API Key:', API_KEY);
        console.log('Base URL:', BASE_URL);
    </script>
</body>
</html>
